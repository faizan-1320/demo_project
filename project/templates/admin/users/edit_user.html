{% extends 'admin/dashboard.html' %}
{% block title %}Edit User{% endblock %}
{% load static %}
{% block content %}
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Edit User</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Home</a></li>
              <li class="breadcrumb-item active">Edit User</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <div class="row">
          <!-- left column -->
          <div class="col-md">
            <!-- general form elements -->
            <div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">Edit User Details</h3>
              </div>
              <!-- /.card-header -->
              <!-- form start -->
              <form>
                {% csrf_token %}
                <div class="card-body">
                  <div class="form-group">
                    <label for="exampleInputEmail1">First Name</label>
                    <input type="text" class="form-control" id="first_name" name="first_name" placeholder="Enter first name" value="{{user.first_name}}">
                    <span class="error" id="error-first_name" ></span><br>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">Last Name</label>
                    <input type="text" class="form-control" id="last_name" name="last_name" placeholder="Enter last name" value="{{user.last_name}}">
                    <span class="error" id="error-last_name" ></span><br>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">Email address</label>
                    <input type="email" class="form-control" id="email" name="email" placeholder="Enter email" value="{{user.email}}">
                    <span class="error" id="error-email" ></span><br>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">Phone Number</label>
                    <input type="text" class="form-control" id="phone_number" name="phone_number" placeholder="Enter phone  number" value="{{user.phone_number}}">
                    <span class="error" id="error-phone_number" ></span><br>
                  </div>
                  <div class="form-group">
                    <label>Select Groups</label>
                    <select class="select2bs4" multiple="multiple" name="groups[]" data-placeholder="Select a State"
                    style="width: 100%;">
                    {% for i in groups %}
                      <option value="{{i.id}}"{% if i.id in user_group_ids %}selected{% endif %}>{{i.name}}</option>
                    {% endfor %}
                    </select>
                  </div>
                </div>
                <div class="card-footer">
                  <button type="submit" class="btn btn-primary">Submit</button>
                </div>
                <!-- /.card-body -->
              </form>
            </div>
            <!-- /.card -->
          </div>
        </div>
      </div>
    </section>
    <!-- /.content -->
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      $('form').on('submit',function(e){
        e.preventDefault();
        $.ajax({
          type:'POST',
          data:$(this).serialize(),
          success:function(res){
            if(res.success){
              Swal.fire({
            icon: 'success',
            title: res.message
          })
          $('.error').text('');
            }else{
              $('.error').text('');
              for(let field in res.errors){
                if(res.errors[field]){
                  $('#error-'+field).text(res.errors[field]).css('color','red')
                }
              }
            }
          }
        })
      })
    })
  </script>
{% endblock content %}
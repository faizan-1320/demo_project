<!DOCTYPE html>
<html lang="en">
{% load static %}
{% load category_tags %}

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>{% block title %}Home | E-Shopper{% endblock %}</title>
	<link href="{% static 'assets/css/bootstrap.min.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/font-awesome.min.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/prettyPhoto.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/animate.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/main.css' %}" rel="stylesheet">
	<link href="{% static 'assets/css/responsive.css' %}" rel="stylesheet">
	<!-- SweetAlert CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


	{% block css %}
	<style>
		.product-name {
			font-size: 14px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			display: block;
		}

		.fixed-size-image {
			width: 150px;
			/* Set the desired width */
			height: 150px;
			/* Set the desired height */
			object-fit: contain;
			/* Ensures the image covers the box, cropping if necessary */
		}
		.pagination {
		display: flex;
		justify-content: center;
		margin: 20px 0;
		}

		.pagination .step-links {
			display: flex;
		}

		.pagination .step-links a {
			color: #007bff;
			margin: 0 5px;
			text-decoration: none;
			padding: 8px 16px;
			border: 1px solid #ddd;
			border-radius: 4px;
		}

		.pagination .step-links a:hover {
			background-color: #f1f1f1;
			border-color: #007bff;
		}

		.pagination .step-links .current {
			padding: 8px 16px;
			margin: 0 5px;
			font-weight: bold;
			border: 1px solid #ddd;
			border-radius: 4px;
			background-color: #007bff;
			color: white;
		}
		.add-to-cart{
    font-size: 9px !important;
    margin-bottom: 7px !important;
}	.add-to-wishlist{
	font-size: 9px !important;
    margin-bottom: 7px !important;
	background: #F5F5ED;
	border: 0 none;
	border-radius: 0;
    color: #696763;
    font-family: 'Roboto', sans-serif;
}
	</style>
	{% endblock %}
</head><!--/head-->

<body>
	<header id="header"><!--header-->
		<div class="header-middle"><!--header-middle-->
			<div class="container">
				<div class="row">
					<div class="col-sm-4">
						<div class="logo pull-left">
							<a href="{% url 'home' %}"><img src="{% static 'assets/images/home/logo.png' %}"
									alt="" /></a>
						</div>
					</div>
					<div class="col-sm-8">
						<div class="shop-menu pull-right">
							<ul class="nav navbar-nav">
								<li>
									<a href="{% url 'cart-detail' %}"><i class="fa fa-shopping-cart"></i> Cart</a>
								</li>														
								<li><a href="{% url 'contact' %}"><i class="fa fa-envelope"></i>Contact</a></li>
								{% if user.is_authenticated %}
								<li><a href="{% url 'wishlist' %}"><i class="fa fa-star"></i> Wishlist</a></li>
								<li class="nav-item dropdown">
									<a href="#" class="nav-link dropdown-toggle" id="userDropdown" role="button"
										data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<i class="fa fa-user"></i> {{ user.first_name }}<span class="caret"></span>
									</a>
									<div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
										<a class="dropdown-item" href="{% url 'user' %}">
											<i class="fa fa-user"></i> Profile
										</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="{% url 'password_change' %}">
											<i class="fa fa-lock"></i> Change Password
										</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="{% url 'order-user' %}">
											<i class="fa fa-shopping-cart"></i> Order
										</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="{% url 'track-order' %}">
											<i class="fa fa-truck"></i> Order Track
										</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="{% url 'logout' %}">
											<i class="fa fa-unlock"></i> Logout
										</a>
									</div>
								</li>
								{% else %}
								<li><a href="{% url 'auth-view' %}"><i class="fa fa-lock"></i>Login/Register</a></li>
								{% endif %}
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div><!--/header-middle-->
	</header><!--/header-->
	{% block content %}
	<section id="slider"><!--slider-->
		<div class="container">
			<div class="row">
				<div class="col-sm-12">
					<div id="slider-carousel" class="carousel slide" data-ride="carousel">
						<ol class="carousel-indicators">
							{% for i in banners %}
							<li data-target="#slider-carousel" data-slide-to="{{ forloop.counter0 }}"
								class="{% if forloop.first %}active{% endif %}"></li>
							{% endfor %}
						</ol>
						<div class="carousel-inner">
							{% for banner in banners %}
							<div class="item {% if forloop.first %}active{% endif %}">
								<div class="col-sm-6">
									<h1><span>E</span>-SHOPPER</h1>
									<h2>Shop Only</h2>
									<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
										incididunt ut labore et dolore magna aliqua.</p>
								</div>
								<div class="col-sm-6">
									<img src="{{ banner.image.url }}" class="girl img-responsive" alt="Banner Image" />
								</div>
							</div>
							{% endfor %}
						</div>

						<a href="#slider-carousel" class="left control-carousel hidden-xs" data-slide="prev">
							<i class="fa fa-angle-left"></i>
						</a>
						<a href="#slider-carousel" class="right control-carousel hidden-xs" data-slide="next">
							<i class="fa fa-angle-right"></i>
						</a>
					</div>
				</div>

			</div>
		</div>
	</section><!--/slider-->

	<section>
		<div class="container">
			<div class="row">
				<div class="col-sm-3">
					<div class="left-sidebar">
						<h2>Category</h2>
						<!-- Categories Accordion -->
						<div class="panel-group category-products" id="accordian">
							{% render_category_tree_tag %}
						</div>
					</div>
				</div>

				<!-- Products Tab -->
				<div class="col-sm-9 padding-right">
					<div class="category-tab">
						<h2 class="title text-center">
							{% if selected_category %}
								{{ selected_category|get_category_name }} Products
							{% else %}
								All Products
							{% endif %}
						</h2>
						
						<div class="col-sm-12">
							<ul class="nav nav-tabs">
								<!-- 'All' category -->
								<li class="{% if selected_category is None %}active{% endif %}">
									<a href="?">All</a>
								</li>
						
								<!-- Loop through categories -->
								{% for category_node in categories %}
									<li class="{% if selected_category and selected_category|add:0 == category_node.category.id %}active{% endif %}">
										<a href="?category={{ category_node.category.id }}">{{ category_node.category.category_name }}</a>
									</li>
								{% endfor %}
							</ul>
						</div>
												
						<div class="tab-content">
							<!-- Show products for each category tab -->
							{% if products %}
								<div class="row">
									{% for product in products %}
										<div class="col-sm-3">
											<div class="product-image-wrapper">
												<div class="single-products">
													<a href="{% url 'product-detail' product.id %}">
														<div class="productinfo text-center">
															{% if product.product.all %}
																<img src="{{ product.product.last.image.url }}" alt="{{ product.name }}" class="fixed-size-image" />
															{% else %}
																<img src="images/home/default_product.jpg" alt="{{ product.name }}" />
															{% endif %}
															<h2>${{ product.price }}</h2>
															<p class="product-name">{{ product.name }}</p>
															<p class="product-quantity" style="color: {% if product.quantity|is_out_of_stock %} red {% else %} green {% endif %};">
																{% if product.quantity|is_out_of_stock %} Out of stock {% else %} In Stock {% endif %}
															</p>
															{% if product.quantity %}
																<div class="button-container">
																	<a href="{% url 'add-to-cart' product.id %}" class="btn btn-default add-to-cart" id="add-to-cart">
																		<i class="fa fa-shopping-cart"></i> Add to cart
																	</a>
																	<a href="{% url 'add-to-wishlist' product.id %}" class="btn btn-default add-to-wishlist" id="add-to-wishlist">
																		<i class="fa fa-heart"></i> Add to wishlist
																	</a>
																</div>
															{% endif %}
														</div>
													</a>
												</div>
											</div>
										</div>
									{% endfor %}
								</div>
							{% else %}
								<p style="text-align: center; color: red; text-decoration: none;">No products available.</p>
							{% endif %}
						</div>
						
						<div class="pagination">
							<span class="step-links">
								{% if products.has_previous %}
									<a href="?page=1{% if selected_category %}&category={{ selected_category }}{% endif %}{% if min_price_filter %}&min_price={{ min_price_filter }}{% endif %}{% if max_price_filter %}&max_price={{ max_price_filter }}{% endif %}">&laquo; first</a>
									<a href="?page={{ products.previous_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}{% if min_price_filter %}&min_price={{ min_price_filter }}{% endif %}{% if max_price_filter %}&max_price={{ max_price_filter }}{% endif %}">previous</a>
								{% endif %}
								
								<span class="current">
									Page {{ products.number }} of {{ products.paginator.num_pages }}.
								</span>
								
								{% if products.has_next %}
									<a href="?page={{ products.next_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}{% if min_price_filter %}&min_price={{ min_price_filter }}{% endif %}{% if max_price_filter %}&max_price={{ max_price_filter }}{% endif %}">next</a>
									<a href="?page={{ products.paginator.num_pages }}{% if selected_category %}&category={{ selected_category }}{% endif %}{% if min_price_filter %}&min_price={{ min_price_filter }}{% endif %}{% if max_price_filter %}&max_price={{ max_price_filter }}{% endif %}">last &raquo;</a>
								{% endif %}
							</span>
						</div>
						
						<div class="features_items">
							<h2 class="title text-center">Featured Items</h2>
							<div class="row">
								{% for featured_product in featured_products %}
									<div class="col-sm-3">
										<div class="product-image-wrapper">
											<div class="single-products">
												
													<div class="productinfo text-center">
														{% if featured_product.product.all %}
															<img src="{{ featured_product.product.last.image.url }}" alt="{{ featured_product.name }}" class="fixed-size-image" />
														{% else %}
															<img src="images/home/default_product.jpg" alt="{{ featured_product.name }}" class="fixed-size-image" />
														{% endif %}
														<h2>${{ featured_product.price }}</h2>
														<p class="product-name">{{ featured_product.name }}</p>
														<p class="product-quantity" style="color: {% if featured_product.quantity|is_out_of_stock %} red {% else %} green {% endif %};">
															{% if featured_product.quantity|is_out_of_stock %} Out of stock {% else %} In Stock {% endif %}
														</p>
														
														<!-- Display buttons based on quantity -->
														{% if featured_product.quantity > 0 %}
															<a href="{% url 'add-to-cart' featured_product.id %}" class="btn btn-default add-to-cart" id="add-to-cart">
																<i class="fa fa-shopping-cart"></i> Add to cart
															</a>
															<a href="{% url 'add-to-wishlist' featured_product.id %}" class="btn btn-default add-to-wishlist" id="add-to-wishlist">
																<i class="fa fa-heart"></i> Add to wishlist
															</a>
														{% endif %}
													</div>
													<div class="product-overlay">
														<div class="overlay-content">
															<h2>${{ featured_product.price }}</h2>
															<a href="{% url 'product-detail' featured_product.id %}">
															<p class="product-name">{{ featured_product.name }}</p></a>
															{% if featured_product.quantity > 0 %}
															<a href="{% url 'add-to-cart' featured_product.id %}" class="btn btn-default add-to-cart" id="add-to-cart">
																<i class="fa fa-shopping-cart"></i> Add to cart
															</a>
															<a href="{% url 'add-to-wishlist' featured_product.id %}" class="btn btn-default add-to-wishlist" id="add-to-wishlist">
																<i class="fa fa-heart"></i> Add to wishlist
															</a>
															{% endif %}
														</div>
													</div>
											</div>
										</div>
									</div>
								{% endfor %}
							</div>
						</div>						
					
				</div>
			</div>
		</div>
	</section>
	{% endblock content %}
	<footer id="footer"><!--Footer-->
		<div class="footer-top">
			<div class="container">
				<div class="row">
					<div class="col-sm-2">
						<div class="companyinfo">
							<h2><span>e</span>-shopper</h2>
							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit,sed do eiusmod tempor</p>
						</div>
					</div>
					<div class="col-sm-7">
					</div>
					<div class="col-sm-3">
						<div class="address">
							<img src="{% static 'assets/images/home/map.png' %}" alt="" />
							<p>Westgate Complex, 5th Floor, Near YMCA Club, Ind(Gujarat)</p>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="footer-widget">
			<div class="container">
				<div class="row">
					<div class="col-sm-9">
						<div class="single-widget">
							<h2>Policies</h2>
							<ul class="nav nav-pills nav-stacked">
								<li><a href="{% url 'contact' %}">Contact Us</a></li>
								<li><a href="http://localhost:8000/pages/terms-and-conditions/">Terms and Conditions</a></li>
								<li><a href="http://localhost:8000/pages/privacy-policy/">Privecy Policy</a></li>
								<li><a href="http://localhost:8000/pages/refund-policy/">Refund Policy</a></li>
								<li><a href="http://127.0.0.1:8000/pages/faq/">FAQ’s</a></li>
							</ul>
						</div>
					</div>
					<div class="col-sm-3">
						<div class="single-widget">
							<h2>About Shopper</h2>
							<form method="post" action="{% url 'home' %}" class="searchform">
								{% csrf_token %}

								<span style="color: red;">{{ form.email.errors }}</span>
								<input type="email" name="email" value="{{ form.email.value|default_if_none:'' }}" placeholder="Your email address" required/>
								<button type="submit" class="btn btn-default">
									<i class="fa fa-arrow-circle-o-right"></i>
								</button>
								
								<p>Get the most recent updates from <br />our site and be updated yourself...</p>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="footer-bottom">
			<div class="container">
				<div class="row">
					<p class="pull-left">Copyright © 2024 E-SHOPPER Inc. All rights reserved.</p>
					<p class="pull-right">Designed by <span><a target="_blank"
								href="https://faizanmahammed-portfolio.netlify.app/">Faizan Diwan</a></span></p>
				</div>
			</div>
		</div>

	</footer><!--/Footer-->

	<script src="{% static 'assets/js/jquery.js' %}"></script>
	<script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
	<script src="{% static 'assets/js/jquery.scrollUp.min.js' %}"></script>
	<script src="{% static 'assets/js/price-range.js' %}"></script>
	<script src="{% static 'assets/js/jquery.prettyPhoto.js' %}"></script>
	<script src="{% static 'assets/js/main.js' %}"></script>
	<!-- SweetAlert JavaScript -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	{% block js %}
	<script>
		"{% if messages %}"
        "{% for message in messages %}"
            Swal.fire({
                toast: true,
                position: 'top-end',
                icon: '{% if message.tags == "error" %}error{% else %}{{ message.tags }}{% endif %}',
                title: '{{ message }}',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
            });
        "{% endfor %}"
    "{% endif %}"
	
	$(document).ready(function() {
    $('.add-to-cart').click(function(e) {
        e.preventDefault();

        var url = $(this).attr('href');
        $.ajax({
            url: url,
            type: 'GET',
            success: function(res) {
                if (res.success) {
                    Swal.fire({
                        toast: true,
                        position: 'top-end',
                        icon: 'success',
                        title: res.message,
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                    })

                    // Update the cart count in the UI
                    $('#cart-count').text(res.cart_count);
                } else {
                    Swal.fire({
                        toast: true,
                        position: 'top-end',
                        icon: 'error',
                        title: res.message,
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                    });
                }
            },
            error: function(xhr, status, error) {
                Swal.fire({
                    toast: true,
                    position: 'top-end',
                    icon: 'error',
                    title: 'Failed to add product to cart!',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                });
            }
        });
    });
});

	</script>
	{% endblock %}
</body>

</html>